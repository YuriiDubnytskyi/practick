(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{125:function(e,t){},128:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(26),c=n.n(o),u=(n(73),n(3)),i=n(11),s=function(e){return a.createElement("div",null,"Hello from singin login",a.createElement("button",{onClick:e.auth.login},"Log In"),a.createElement("button",{onClick:e.auth.login},"Sing In"))},l=n(1),m=function(e){var t=Object(u.g)();return Object(a.useEffect)((function(){if(!/access_token|id_token|error/.test(window.location.hash))throw new Error("Invalid callback URL.");console.log(t),e.auth.handleAuthentication(t);for(var n=0,a=Object.entries(localStorage);n<a.length;n++){var r=Object(l.a)(a[n],2),o=r[0];r[1];"access_token"!==o&&"id_token"!==o&&"expires_at"!==o&&"scopes"!==o&&localStorage.removeItem(o)}}),[]),r.a.createElement("div",null,"Loading...")},f=function(e){var t=e.auth;return r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0,render:function(e){return t.isAuthenticated()?r.a.createElement(u.a,{to:"/about"}):r.a.createElement(s,{auth:t})}}),r.a.createElement(u.b,{path:"/callback",exact:!0},r.a.createElement(m,Object.assign({auth:e.auth},e))))},h=n(5),d=function(e){return a.createElement("div",null,a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},a.createElement("ul",{className:"navbar-nav"},a.createElement("li",{className:"nav-item"},a.createElement(i.b,{className:"nav-link",to:"/main"},"Main")),a.createElement("li",{className:"nav-item"},a.createElement(i.b,{className:"nav-link",to:"/about"},"About")),a.createElement("button",{className:"nav-item",onClick:function(){return e.auth.logout()}},"LogOut"))))},g=n(13),b=n.n(g),p=function(e){return b.a.get("/api/users/search/"+e,e).then((function(e){return console.log("resultFull"+e),e}))},E=n(21),O=n.n(E),v=n(38),j=function(){var e=Object(v.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(!t.email_vefified),!t.email_verified){e.next=5;break}return e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(v.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t);case 2:return n=e.sent,e.next=5,n.data;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=n(6),I=n(4),_=function(e){return{type:"SET_USER_DATA",data:e}},A=function(e){return{type:"UPDATE_USER_DATA",data:e}},y=function(){return{type:"DELETE_USER"}},w=function(e){return{type:"GET_ALL",users:e}},D=function(e){return{type:"ADD_MESS",mess:e}},T=function(e){return{type:"ADD_ROOM",room:e}},C=function(e){return{type:"ADD_INIT_MESS",mess:e}},N=function(){return{type:"REMOVE_MESS"}},M=function(e){return{type:"INIT_NOTIFICATION",initData:e}},U=function(e){return{type:"ADD_NOTIFICATION",addData:e}},R=Object(k.b)((function(e){return{userInf:e.user}}),(function(e){return Object(h.a)({dispatch:e},Object(I.b)({setUserData:_,updateUserData:A,deleteUser:y},e))}))((function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),o=(n[0],n[1]),c=Object(a.useState)(""),i=Object(l.a)(c,2),s=i[0],m=i[1],f=Object(a.useState)(""),h=Object(l.a)(f,2),g=h[0],p=h[1],E=Object(a.useState)(""),O=Object(l.a)(E,2),v=O[0],k=O[1],I=Object(a.useState)(""),_=Object(l.a)(I,2),A=_[0],y=_[1],w=Object(a.useState)(""),D=Object(l.a)(w,2),T=D[0],C=D[1],N=Object(a.useState)(!1),M=Object(l.a)(N,2),U=M[0],R=M[1],x=Object(u.g)();Object(a.useEffect)((function(){e.userInf.isAuth?L(e.userInf,!0):e.auth.getProfile((function(e){o(e);var t=e.email,n=e.nickname,a=e.name,r=e.family_name;j(e).then((function(e){return e?S(t).then((function(e){return 404!==e.status?L(e):function(e){return b.a.post("/api/users/create",e).then((function(e){return e}))}({email:t,nickname:n,name:a,family_name:r})})).then((function(e){void 0===e?console.log("error"):L(e.data)})):x.push("/verified")}))}))}),[]);var L=function(t){var n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a?(k(t.id),console.log("hereTrue"),n=t.id):(k(t._id),n=t._id),m(t.name),p(t.email),y(t.nickname),C(t.family_name),console.log(t);var r={name:t.name,email:t.email,nickname:t.nickname,family_name:t.family_name,id:n};e.setUserData(r)};return r.a.createElement("div",null,r.a.createElement(d,{auth:e.auth}),"Hello from about -",s,"-",g,"-",A,"-",T,r.a.createElement("p",null,"Your Account"),r.a.createElement("p",null,"Name -- ",s),U?r.a.createElement("input",{value:s,name:"name",onChange:function(e){return m(e.target.value)}}):r.a.createElement(r.a.Fragment,null),r.a.createElement("p",null,"Surname -- ",T),U?r.a.createElement("input",{value:T,name:"family_name",onChange:function(e){return C(e.target.value)}}):r.a.createElement(r.a.Fragment,null),r.a.createElement("p",null,"Nickname -- ",A," users can find you"),U?r.a.createElement("input",{value:A,name:"nickname",onChange:function(e){return y(e.target.value)}}):r.a.createElement(r.a.Fragment,null),U?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){var t;(t={id:v,name:s,nickname:A,family_name:T},b.a.put("/api/users/updateUser",t).then((function(e){return e.data}))).then((function(t){return t.name?e.updateUserData({name:t.name,family_name:t.family_name,nickname:t.nickname}):console.log("error")})).then((function(){return R(!1)}))}},"Save"),r.a.createElement("button",{onClick:function(){m(e.userInf.name),y(e.userInf.nickname),C(e.userInf.family_name),R(!1)}},"Cansel")):r.a.createElement("button",{onClick:function(){return R(!0)}},"Update"),r.a.createElement("p",null,"Danger Zone"),r.a.createElement("button",{onClick:function(){(function(e){return b.a.delete("/api/users/deleteUser/"+e,e).then((function(e){return e.status}))})(v).then((function(t){200===t?e.deleteUser():console.log("error")})).then((function(){e.auth.logout()}))}},"DELETE ACOUNT"))})),x=Object(k.b)((function(e){return{userInf:e.user,userAll:e.users.users}}),(function(e){return Object(h.a)({dispatch:e},Object(I.b)({getAllUsers:w},e))}))((function(e){var t=Object(a.useState)([]),n=Object(l.a)(t,2),o=n[0],c=n[1],u=Object(a.useState)([]),i=Object(l.a)(u,2),s=i[0],m=i[1];Object(a.useEffect)((function(){b.a.get("/api/users/getAll").then((function(e){return e.data})).then((function(t){e.getAllUsers(t),c(t.filter((function(t){return t.email!==e.userInf.email})))}))}),[]);return r.a.createElement("div",null,r.a.createElement("input",{placeholder:"Search user",onChange:function(e){var t=o.filter((function(t){return-1!==t.nickname.toLowerCase().search(e.target.value.toLowerCase())}));""===e.target.value?m([]):m(t)}}),s.map((function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,t.nickname),r.a.createElement("button",{onClick:function(){return e.startChat(t.email)}},"Chat+"))})))})),L=Object(k.b)((function(e){return{userInf:e.user,userAll:e.users.users,mess:e.messages.messages,notification:e.notifications.notifications}}),(function(e){return Object(h.a)({dispatch:e},Object(I.b)({addInitMess:C,addRoom:T},e))}))((function(e){var t=Object(a.useState)([]),n=Object(l.a)(t,2),o=(n[0],n[1],Object(a.useState)([])),c=Object(l.a)(o,2),i=c[0],s=c[1],m=Object(a.useState)(""),f=Object(l.a)(m,2),h=f[0],d=f[1],g=Object(a.useState)(""),p=Object(l.a)(g,2),E=p[0],O=p[1],v=Object(u.g)();Object(a.useEffect)((function(){O(e.data.room),s(e.data.messages),e.data.users[0]===e.userInf.email?d(e.data.users[1]):d(e.data.users[0])}),[]);return r.a.createElement("div",null,r.a.createElement("p",null,function(e,t){var n=e.filter((function(e){return e.email===t}));return console.log(n[0]+"9090909090909090909"),0===n.length?"":n[0].name}(e.userAll,h)),r.a.createElement("button",{onClick:function(){0!==e.notification[0][E]?function(e){return b.a.get("/api/rooms/getRoomsMessages/"+e,e).then((function(e){return e.data[0].messages}))}(E).then((function(t){console.log("mmmmmeeeessss"+t),e.addInitMess(t)})):e.addInitMess(i),console.log("hereMess"+e.data),e.addRoom(E),v.push("/chat")}},"Go Chat"),r.a.createElement("p",null,0===e.notification.length?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,e.notification[0][E])))})),F=n(15),P=n.n(F),V=function(e,t,n){null!==localStorage.getItem("".concat(t).concat(n))&&"false"!==localStorage.getItem("".concat(t).concat(n))||(e.emit("new-user",n),console.log("11111111111111"),localStorage.setItem("".concat(t).concat(n),"true"))},J=Object(k.b)((function(e){return{userInf:e.user,userAll:e.users.users,mess:e.messages.messages,roomChat:e.room.room,notification:e.notifications.notifications}}),(function(e){return Object(h.a)({dispatch:e},Object(I.b)({addMess:D,removeMess:N,initNotification:M,addNotification:U},e))}))((function(e){var t=Object(a.useState)([]),n=Object(l.a)(t,2),o=n[0],c=n[1],u=Object(a.useState)("https://practick.herokuapp.com/"),i=Object(l.a)(u,2),s=i[0],m=(i[1],P()(s));return Object(a.useEffect)((function(){var t;(t=e.email,b.a.get("/api/rooms/getRoomsUsers/"+t,t).then((function(e){return e.data}))).then((function(t){c(t);var n={};t.map((function(t){V(m,e.email,t.room),n[t.room]=0})),e.initNotification(n)}))}),[]),Object(a.useEffect)((function(){m.on("chat-message",(function(t){"/chat"===window.location.pathname?(console.log("herererere"+t.message),t.email!==e.userInf.email&&e.addMess({mess:t.message,name:t.name})):(e.addNotification(t.room),alert("You have SMS from"+t.name))}))})),r.a.createElement("div",null,o.map((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{data:e}))})))})),q=Object(k.b)((function(e){return{userInf:e.user,userAll:e.users.users}}),(function(e){return Object(h.a)({dispatch:e},Object(I.b)({getAllUsers:w,addRoom:T},e))}))((function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),o=(n[0],n[1],Object(a.useState)("")),c=Object(l.a)(o,2),i=(c[0],c[1],Object(a.useState)("https://practick.herokuapp.com/")),s=Object(l.a)(i,2),m=s[0],f=(s[1],P()(m)),h=Object(u.g)();Object(a.useEffect)((function(){if(""===e.userInf.name){for(var t=0,n=Object.entries(localStorage);t<n.length;t++){var a=Object(l.a)(n[t],2),r=a[0];a[1];"access_token"!==r&&"id_token"!==r&&"expires_at"!==r&&"scopes"!==r&&localStorage.setItem(r,"false")}h.push("/about")}}),[]);return Object(a.useEffect)((function(){f.on("chat-message",(function(e){console.log("heredata121212121212"+e)}))})),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(d,{auth:e.auth}),r.a.createElement(x,{startChat:function(t){var n,a,r={id1:t,id2:e.userInf.email};console.log("chat"+r),(n=r.id1,a=r.id2,b.a.get("/api/rooms/getRoom/"+n+"/"+a).then((function(e){return e.data}))).then((function(t){e.addRoom(t.room)})).then((function(){h.push("/chat")}))}}),r.a.createElement(J,{email:e.userInf.email})))})),H=function(e){return a.createElement("div",null,"Please verifide your account and log",a.createElement("button",{onClick:function(){return e.auth.login()}},"Login"))},W=Object(k.b)((function(e){return{userInf:e.user,userAll:e.users.users,mess:e.messages.messages,roomChat:e.room.room}}),(function(e){return Object(h.a)({dispatch:e},Object(I.b)({addMess:D,removeMess:N,addNotification:U},e))}))((function(e){var t=Object(a.useState)("https://practick.herokuapp.com/"),n=Object(l.a)(t,2),o=n[0],c=(n[1],Object(a.useState)("")),i=Object(l.a)(c,2),s=i[0],m=i[1],f=Object(a.useState)([]),h=Object(l.a)(f,2),d=h[0],g=(h[1],Object(u.g)()),p=P()(o);Object(a.useEffect)((function(){V(p,e.userInf.email,e.roomChat)}),[]),Object(a.useEffect)((function(){p.on("chat-message",(function(t){console.log("heredata"+d),console.log("herererere888888888888888888888888"+g),"/chat"===window.location.pathname?t.email!==e.userInf.email&&e.addMess({mess:t.message,name:t.name}):(e.addNotification(t.room),alert("You have SMS from"+t.name))}))}));return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){e.removeMess(),g.push("/main")}},"EXIT CHAT"),e.roomChat,e.mess.map((function(e){return r.a.createElement("p",null,e.name," -- ",e.mess)})),r.a.createElement("input",{value:s,onChange:function(e){return m(e.target.value)}}),r.a.createElement("button",{onClick:function(){console.log("room"+e.roomChat);var t=P()(o);e.addMess({mess:s,name:e.userInf.name}),t.emit("send-chat-message",e.roomChat,s,e.userInf.email,e.userInf.name);var n,a=e.mess;a.push({mess:s,name:e.userInf.name}),console.log("66666666666666666666666"),n={room:e.roomChat,mess:a},b.a.put("/api/rooms/updateMess",n).then((function(e){return e.data})),m("")}},"Send"))})),G=function(e){var t=e.auth;return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/about",exact:!0,render:function(e){return t.isAuthenticated()?r.a.createElement(R,{auth:t}):r.a.createElement(u.a,{to:"/"})}}),r.a.createElement(u.b,{path:"/main",exact:!0,render:function(e){return t.isAuthenticated()?r.a.createElement(q,{auth:t}):r.a.createElement(u.a,{to:"/"})}}),r.a.createElement(u.b,{path:"/verified",exact:!0,render:function(e){return t.isAuthenticated()?r.a.createElement(H,{auth:t}):r.a.createElement(u.a,{to:"/"})}}),r.a.createElement(u.b,{path:"/chat",exact:!0,render:function(e){return t.isAuthenticated()?r.a.createElement(W,{auth:t}):r.a.createElement(u.a,{to:"/"})}})))},X=n(64),Y=n(65),B=n(66),Q=function(){function e(t){var n=this;Object(X.a)(this,e),this.login=function(){n.auth0.authorize()},this.handleAuthentication=function(e){n.auth0.parseHash((function(t,a){a&&a.accessToken&&a.idToken?(n.setSession(a),console.log(n),e.push("/about")):t&&(console.log(n),e.push("/"),alert("Error: ".concat(t.error,". Check the console for further details.")),console.log(t))}))},this.setSession=function(e){console.log(e);var t=JSON.stringify(1e3*e.expiresIn+(new Date).getTime()),a=e.scope||n.requestedScopes||"";localStorage.setItem("access_token",e.accessToken),localStorage.setItem("id_token",e.idToken),localStorage.setItem("expires_at",t),localStorage.setItem("scopes",JSON.stringify(a))},this.logout=function(){localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),localStorage.removeItem("scopes"),n.userProfile=null,n.auth0.logout({clientID:"Vlvnr3poW9Ors21ydAosVRRpVncQlvqS",returnTo:"https://practick.herokuapp.com"})},this.getAccessToken=function(){var e=localStorage.getItem("access_token");if(!e)throw new Error("No access token found.");return e},this.getProfile=function(e){if(n.userProfile)return e(n.userProfile);n.auth0.client.userInfo(n.getAccessToken(),(function(t,a){a&&(n.userProfile=a),e(a,t)}))},this.history=t,this.userProfile=null,this.requestedScopes="openid profile email read:courses",this.auth0=new B.a.WebAuth({domain:"yurii-dubnytskyi.eu.auth0.com",clientID:"Vlvnr3poW9Ors21ydAosVRRpVncQlvqS",redirectUri:"https://practick.herokuapp.com/callback",responseType:"token id_token",scope:this.requestedScopes}),console.log(this)}return Object(Y.a)(e,[{key:"isAuthenticated",value:function(){var e=JSON.parse(localStorage.getItem("expires_at"));return(new Date).getTime()<e}},{key:"userHasScopes",value:function(e){var t=(JSON.parse(localStorage.getItem("scopes"))||"").split(" ");return e.every((function(e){return t.includes(e)}))}}]),e}(),z=function(e){Object(u.g)();console.log(e.history);var t=new Q(window.history);return r.a.createElement("div",null,r.a.createElement(i.a,null,r.a.createElement(f,Object.assign({auth:t},e)),r.a.createElement(G,{auth:t})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=n(67),$=function(e,t){return Object(h.a)(Object(h.a)({},e),t)},K={id:0,name:"",email:"",nickname:"",family_name:"",isAuth:!1},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_DATA":return $(e,{id:t.data.id,name:t.data.name,email:t.data.email,nickname:t.data.nickname,family_name:t.data.family_name,isAuth:!0});case"UPDATE_USER_DATA":return $(e,{name:t.data.name,nickname:t.data.nickname,family_name:t.data.family_name});case"DELETE_USER":return $(e,{id:0,name:"",email:"",nickname:"",family_name:"",isAuth:!1});default:return e}},te=n(18),ne={users:[]},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL":return $(e,{users:Object(te.a)(t.users)});default:return e}},re={messages:[]},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_MESS":return $(e,{messages:[].concat(Object(te.a)(e.messages),[t.mess])});case"ADD_INIT_MESS":return $(e,{messages:t.mess});case"REMOVE_MESS":return $(e,{messages:[]});default:return e}},ce={room:""},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ROOM":return $(e,{room:t.room});default:return e}},ie={notifications:[]},se=function(e,t){return e[0][t]=e[0][t]+1,e},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_NOTIFICATION":return $(e,{notifications:[t.initData]});case"ADD_NOTIFICATION":return $(e,{notifications:[].concat(Object(te.a)(e.notifications),[se(e.notifications,t.addData)])});default:return e}},me=Object(I.c)({user:ee,users:ae,messages:oe,room:ue,notifications:le}),fe=window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||I.d,he=Object(I.e)(me,fe(Object(I.a)((function(e){return function(t){return function(n){console.log("[Middleware] Dispatching",n);var a=t(n);return console.log("[Middleware] next state",e.getState()),a}}}),Z.a)));c.a.render(r.a.createElement(k.a,{store:he},r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},68:function(e,t,n){e.exports=n(128)},73:function(e,t,n){}},[[68,1,2]]]);
//# sourceMappingURL=main.a1bf12ab.chunk.js.map